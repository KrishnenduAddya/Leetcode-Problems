// Amazon Adobe Sumo Logic

// Binary Search on Answer

public class Solution {
    public int ShipWithinDays(int[] weights, int days) {
        // The minimum ship capacity must be at least the maximum weight in weights (otherwise that package canâ€™t be shipped)
        int low = weights.Max();

        // The maximum ship capacity could be the sum of all weights (ship everything in one day)
        int high = weights.Sum();

        int capacity = 0;
        while(low <= high)
        {
            int mid = low + (high - low) / 2;
            // If shipping possible for capacity = mid, so we will check whether we can minimize the capacity to a lesser weight or not
            if(CanShip(weights, days, mid))
            {
                capacity = mid;
                high = mid - 1;
            }
            else // else increase weight for capacity
                low = mid + 1;
        }

        return capacity;
    }

    private bool CanShip(int[] weights, int days, int mid)
    {
        // daysCount stores in how many days all weights can be shipped for a given capacity = mid
        int daysCount = 1;
        int currentLoad = 0;
        foreach(int weight in weights)
        {
            // If adding next weight, capacity does not exceed then add that weight in belt and can be shipped in the same day
            if(currentLoad + weight <= mid)
            {
                currentLoad = currentLoad + weight;
            }
            else // else one extra day will be needed, weight starts from that weight
            {
                currentLoad = weight;
                daysCount++;
            }
        }
        
        // If daysCount <= days i.e shipping possible for capacity = mid
        return daysCount <= days;
    }
}
